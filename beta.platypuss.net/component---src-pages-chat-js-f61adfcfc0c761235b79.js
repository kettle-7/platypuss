"use strict";(self.webpackChunkplatypuss_beta=self.webpackChunkplatypuss_beta||[]).push([[649],{4852:function(e,t,n){n.d(t,{z:function(){return r}});var s=n(6540);const r=({title:e,iconClickEvent:t})=>s.createElement("header",null,s.createElement("img",{onClick:t||(()=>{window.location="/"}),style:{cursor:"pointer"},src:"/icons/icon-48x48.png"}),s.createElement("h2",{onClick:()=>{window.location="/"},style:{cursor:"pointer"}},e||"(Beta!) Platypuss"))},6965:function(e,t,n){n.r(t),n.d(t,{Head:function(){return E},default:function(){return g}});var s=n(4852),r=n(6540),o={},a={populated:!1},l={},i={},c="undefined"!=typeof window,d=c?new URL(window.location):new URL("http://localhost:8000"),m="https://platypuss.net";function u(e,t=20){let n=3735928559^t,s=1103547991^t;for(let r,o=0;o<e.length;o++)r=e.charCodeAt(o),n=Math.imul(n^r,2654435761),s=Math.imul(s^r,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),(s>>>0).toString(16).padStart(8,0)+(n>>>0).toString(16).padStart(8,0)}function v({shown:e}){return r.createElement("div",{className:"sidebar",id:"serversBar",style:{display:e?"flex":"none"}},r.createElement("img",{className:"serverIcon",src:"",alt:"+",id:"newServerButton"}),Object.values(a.servers).map((e=>r.createElement(b,{server:e}))))}function f({focusedServer:e,shown:t}){return r.createElement("div",{className:"sidebar",id:"serversBar",style:{display:t?"flex":"none"}},r.createElement("img",{className:"serverIcon material-symbols-outlined",src:"",alt:"+",id:"newServerButton"}))}function h({message:e}){return r.createElement("div",{className:"message1"},r.createElement("img",{src:o[e.author].avatar,alt:""}),r.createElement("div",{className:"message2"},r.createElement("h3",{className:"messageUsernameDisplay"},o[e.author].username),r.createElement("p",null,e.content)))}function p({shown:e}){return r.createElement("div",{id:"middleSection",style:{display:e?"flex":"none"}},r.createElement("div",{id:"aboveScrolledArea"}),r.createElement("div",{id:"scrolledArea"}," ",r.createElement("div",{id:"aboveMessageArea"}),r.createElement("div",{id:"messageArea"},Object.values(a.focusedRoomRenderedMessages).map((e=>r.createElement(h,null)))),r.createElement("div",{id:"belowMessageArea"})),r.createElement("div",{style:{height:5,background:"linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.3))"}}),r.createElement("div",{id:"belowScrolledArea"},r.createElement("div",{contentEditable:!0,id:"messageBox"}),r.createElement("button",null,"upload"),r.createElement("button",null,"send")))}function b({server:e}){return[e.manifest,e.setManifest]=r.useState({icon:"",title:"Couldn't connect to this server 🐙"}),r.createElement("div",{className:"popoverContainer"},r.createElement("img",{className:"serverIcon",src:e.manifest.icon,alt:"🐙"}),r.createElement("div",{className:"serverIconPopover"},e.manifest.title))}function S({room:e}){return r.createElement("div",{className:"roomLink",style:{cursor:"pointer"}},r.createElement("a",null,e.name))}function w({shown:e}){return r.createElement("div",{className:"sidebar",id:"roomsBar",style:{display:e?"flex":"none"}},r.createElement("div",{id:"serverTitle"},r.createElement("h3",{style:{margin:5,cursor:"pointer"}},"server name goes here ???"),r.createElement("span",{class:"material-symbols-outlined"},"stat_minus_1")),Object.values(a.focusedServerRenderedRooms).map((e=>r.createElement(S,{server:e}))),0==Object.values(a.focusedServerRenderedRooms).length?r.createElement("p",null,"This server doesn't have any rooms in it."):r.createElement(r.Fragment,null))}d.protocol="https";const E=()=>r.createElement("title",null,"(Beta!) Platypuss");function g(){return[a.servers,a.setServers]=r.useState({}),[a.focusedRoomRenderedMessages,a.setFocusedRoomRenderedMessages]=r.useState({}),[a.focusedServer,a.setFocusedServer]=r.useState({manifest:{}}),[a.focusedRoom,a.setFocusedRoom]=r.useState({}),[a.focusedServerRenderedRooms,a.setFocusedServerRenderedRooms]=r.useState({}),[a.mobileSidebarShown,a.setMobileSidebarShown]=r.useState(!0),[a.useMobileUI,a.setUseMobileUI]=r.useState(!!c&&2.54*window.innerWidth/96/window.devicePixelRatio<20),c&&window.addEventListener("resize",(()=>{a.setUseMobileUI(!!c&&2.54*window.innerWidth/96/window.devicePixelRatio<20)})),console.log(a.populated),a.populated||async function(){if("undefined"!=typeof window){for(let e of Object.keys(a.focusedRoomRenderedMessages))delete a.focusedRoomRenderedMessages[e];a.setFocusedRoomRenderedMessages({}),fetch(`${m}/getServerTokens?id=${localStorage.getItem("sessionID")}`).then((e=>e.json())).then((async function(e){for(let n of Object.values(l))n.close();for(let n in e.servers)i[n]=u(n),a.focusedServer=={manifest:{}}&&window.location.toString().replace(/^.*\#/g,"")==i[n]&&a.setFocusedServer(n);let t={};for(let n of Object.keys(e.servers)){let e=n.split(" "),s=e[0],r=e[1],o=e[2];t[n]={ip:s,inviteCode:r,subserver:o,manifest:{title:"Loading",icon:"/icon.png",memberCount:0,public:!1,description:"Waiting for a response from the server"}},fetch(d.protocol+"//"+s+"/"+o).then((e=>e.json())).then((e=>{t=a.servers,t[n].setManifest(e),a.setServers(t)})).catch((e=>{console.log(e)})),new WebSocket(("https:"==d.protocol?"wss:":"ws")+"//"+s)}console.log(t),a.setServers(t),a.focusedServer=={manifest:{}}&&a.setFocusedServer(a.servers[Object.keys(e.servers)[0]])})).catch((e=>console.log(e)))}}(),a.populated=!0,r.createElement(r.Fragment,null,r.createElement(s.z,{title:a.focusedServer.manifest.title,iconClickEvent:()=>{a.useMobileUI?a.setMobileSidebarShown(!a.mobileSidebarShown):window.location="/"}}),r.createElement("main",null,r.createElement("div",{id:"chatPage"},r.createElement(v,{shown:a.mobileSidebarShown||!a.useMobileUI}),r.createElement(w,{shown:a.mobileSidebarShown||!a.useMobileUI}),r.createElement(p,{shown:!a.mobileSidebarShown||!a.useMobileUI}),r.createElement(f,{shown:a.mobileSidebarShown||!a.useMobileUI}))))}}}]);
//# sourceMappingURL=component---src-pages-chat-js-f61adfcfc0c761235b79.js.map